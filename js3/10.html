<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simple Pokemon Viewer</title>
  </head>
  <body>
    <div class="nav">
      <button type="submit" class="prev">Previous</button>
      <button type="submit" class="next">Next</button>
    </div>
    <div class="pokemons"></div>
  </body>
  <script>
    const pokeUrl = "https://pokeapi.co/api/v2/pokemon/";
    let pokeNextUrl = null;
    let pokePrevUrl = null;

    const pokemonsTag = document.querySelector(".pokemons");
    const pokePrev = document.querySelector(".prev");
    const pokeNext = document.querySelector(".next");

    const getNextPokemons = (url) => {
      fetch(url)
        .then((resp) => {
          return resp.json();
        })
        .then((data) => {
          pokeNextUrl = data.next;
          pokePrevUrl = data.previous;
          const getAllPokeUrls = data.results.map((pokemon) => {
            return fetch(pokemon.url).then((poke) => {
              return poke.json();
            });
          });
          return Promise.all(getAllPokeUrls);
        })
        .then((pokemons) => {
          return pokemons.reduce((acc, pokemon) => {
            return `${acc}<div><h1>${pokemon.name}</h1><img src="${pokemon.sprites.front_default}"></div>`;
          }, "");
        })
        .then((pokeHtml) => {
          pokemonsTag.innerHTML = pokeHtml;
        })
        .catch((error) => {
          console.log(error);
        });
    };

    pokeNext.onclick = () => {
      pokemonsTag.innerHTML = "Loading";
      getNextPokemons(pokeNextUrl);
    };

    pokePrev.onclick = () => {
      if (pokePrevUrl) {
        pokemonsTag.innerHTML = "Loading";
        getNextPokemons(pokePrevUrl);
      }
    };

    getNextPokemons(pokeUrl);
  </script>
</html>
